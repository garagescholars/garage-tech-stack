<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Garage Scholars — Video Screen</title>
  <style>
    /* ── ScholarHub Design Tokens (from mobile/src/constants/theme.ts) ── */
    :root {
      --bg-primary: #0a0f1a;
      --bg-secondary: #111827;
      --bg-card: #1a2332;
      --bg-input: #141c2b;
      --bg-elevated: #1e2a3a;
      --border-default: #2a3545;
      --border-divider: #1e293b;
      --border-focus: #14b8a6;
      --text-primary: #f1f5f9;
      --text-secondary: #8b9bb5;
      --text-muted: #5a6a80;
      --text-heading: #ffffff;
      --brand-teal: #14b8a6;
      --brand-teal-dark: #0d9488;
      --brand-teal-light: #2dd4bf;
      --status-success: #10b981;
      --status-warning: #f59e0b;
      --status-error: #ef4444;
      --status-info: #3b82f6;
      --radius-xs: 6px;
      --radius-sm: 10px;
      --radius-md: 14px;
      --radius-lg: 18px;
      --radius-xl: 24px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100dvh;
      display: flex;
      flex-direction: column;
      -webkit-font-smoothing: antialiased;
    }

    /* ── Header ── */
    .header {
      padding: 16px 20px;
      background: var(--bg-primary);
      border-bottom: 1px solid var(--border-divider);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      gap: 4px;
    }
    .header-brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .header-icon {
      width: 28px;
      height: 28px;
      background: var(--brand-teal);
      border-radius: var(--radius-xs);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .header-icon svg { width: 16px; height: 16px; fill: var(--text-heading); }
    .header h1 {
      font-size: 17px;
      font-weight: 700;
      color: var(--text-heading);
      letter-spacing: -0.2px;
    }
    .header .step {
      font-size: 12px;
      font-weight: 700;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    /* ── Progress Bar ── */
    .progress-bar {
      height: 4px;
      background: var(--border-default);
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--brand-teal), #0ea5e9);
      border-radius: 0 2px 2px 0;
      transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* ── Main Content ── */
    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 20px;
      max-width: 640px;
      margin: 0 auto;
      width: 100%;
    }

    /* ── Screens ── */
    .screen { display: none; flex-direction: column; flex: 1; }
    .screen.active { display: flex; }

    /* ── Card Component ── */
    .card {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: 18px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.12);
    }

    /* ── Welcome Screen ── */
    .welcome-card {
      padding: 32px 24px;
      text-align: center;
      margin-top: 20px;
    }
    .welcome-card h2 {
      font-size: 22px;
      font-weight: 700;
      color: var(--text-heading);
      letter-spacing: -0.2px;
      margin-bottom: 12px;
    }
    .welcome-card .subtitle {
      color: var(--text-secondary);
      font-size: 15px;
      line-height: 1.6;
      margin-bottom: 20px;
    }

    /* ── Tips List ── */
    .tips-list {
      text-align: left;
      background: var(--bg-primary);
      border-radius: var(--radius-sm);
      padding: 16px 18px;
      margin: 16px 0 24px;
      list-style: none;
    }
    .tips-list li {
      color: var(--text-primary);
      font-size: 14px;
      padding: 8px 0;
      padding-left: 28px;
      position: relative;
      border-bottom: 1px solid var(--border-divider);
    }
    .tips-list li:last-child { border-bottom: none; }
    .tips-list li::before {
      content: "";
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: rgba(20, 184, 166, 0.15);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .tips-list li::after {
      content: "\2713";
      position: absolute;
      left: 4px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--brand-teal);
      font-size: 11px;
      font-weight: 700;
    }
    .tips-note {
      font-size: 12px;
      color: var(--text-muted);
      font-weight: 600;
      letter-spacing: 0.2px;
    }

    /* ── Prompt Card ── */
    .prompt-card {
      margin-bottom: 14px;
    }
    .prompt-label {
      font-size: 12px;
      font-weight: 700;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }
    .prompt-text {
      font-size: 16px;
      line-height: 1.6;
      color: var(--text-primary);
      font-weight: 500;
    }

    /* ── Video Container ── */
    .video-container {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      border-radius: var(--radius-lg);
      overflow: hidden;
      background: #000;
      min-height: 280px;
      max-height: 420px;
      border: 1px solid var(--border-default);
    }
    .video-container video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transform: scaleX(-1);
    }

    /* ── Timer Overlay ── */
    .timer-overlay {
      position: absolute;
      top: 12px;
      right: 12px;
      border-radius: 20px;
      padding: 6px 14px;
      font-size: 13px;
      font-weight: 700;
      letter-spacing: 0.5px;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }
    .timer-overlay.recording {
      color: var(--status-error);
      background: rgba(239, 68, 68, 0.15);
      border: 1px solid rgba(239, 68, 68, 0.3);
    }
    .timer-overlay.prep {
      color: var(--status-warning);
      background: rgba(245, 158, 11, 0.15);
      border: 1px solid rgba(245, 158, 11, 0.3);
    }

    /* ── Recording Dot ── */
    .rec-dot {
      display: inline-block;
      width: 8px;
      height: 8px;
      background: var(--status-error);
      border-radius: 50%;
      margin-right: 6px;
      animation: pulse 1s infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* ── Buttons ── */
    .btn {
      display: block;
      width: 100%;
      padding: 16px;
      border: none;
      border-radius: var(--radius-md);
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 16px;
      transition: all 0.2s ease;
      letter-spacing: 0.1px;
      min-height: 52px;
    }
    .btn:active { transform: scale(0.97); }
    .btn:disabled { opacity: 0.4; cursor: not-allowed; transform: none; }

    .btn-primary {
      background: var(--brand-teal);
      color: var(--text-heading);
      box-shadow: 0 4px 12px rgba(20, 184, 166, 0.3);
    }
    .btn-primary:hover:not(:disabled) { background: var(--brand-teal-dark); }

    .btn-danger {
      background: var(--status-error);
      color: var(--text-heading);
      box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
    }

    .btn-secondary {
      background: var(--bg-card);
      color: var(--text-primary);
      border: 1px solid var(--border-default);
    }

    /* ── Upload Progress ── */
    .upload-track {
      width: 100%;
      height: 8px;
      background: var(--border-default);
      border-radius: 4px;
      margin-top: 20px;
      overflow: hidden;
    }
    .upload-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--brand-teal), #0ea5e9);
      border-radius: 4px;
      transition: width 0.3s ease;
    }

    /* ── Done Screen ── */
    .done-card {
      padding: 40px 24px;
      text-align: center;
      margin-top: 40px;
    }
    .done-icon {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background: rgba(16, 185, 129, 0.15);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
    }
    .done-icon svg { width: 32px; height: 32px; stroke: var(--status-success); fill: none; stroke-width: 2.5; }
    .done-card h2 {
      font-size: 22px;
      font-weight: 700;
      color: var(--text-heading);
      margin-bottom: 12px;
    }
    .done-card p { color: var(--text-secondary); font-size: 15px; line-height: 1.6; }

    /* ── Error Screen ── */
    .error-card {
      padding: 32px 24px;
      text-align: center;
      margin-top: 40px;
    }
    .error-icon {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background: rgba(239, 68, 68, 0.15);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
    }
    .error-icon svg { width: 32px; height: 32px; stroke: var(--status-error); fill: none; stroke-width: 2.5; }
    .error-card h2 {
      font-size: 20px;
      font-weight: 700;
      color: var(--status-error);
      margin-bottom: 12px;
    }
    .error-card p { color: var(--text-secondary); font-size: 14px; line-height: 1.6; }

    /* ── Status Message ── */
    .status-msg {
      text-align: center;
      font-size: 13px;
      color: var(--text-muted);
      margin-top: 8px;
      font-weight: 500;
    }

    /* ── Badge ── */
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 3px 8px;
      border-radius: var(--radius-xs);
      font-size: 10px;
      font-weight: 700;
      letter-spacing: 0.8px;
      text-transform: uppercase;
    }
    .badge-teal {
      background: rgba(20, 184, 166, 0.15);
      color: var(--brand-teal);
    }
    .badge-dot {
      width: 5px;
      height: 5px;
      border-radius: 50%;
      background: currentColor;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="header">
    <div class="header-brand">
      <div class="header-icon">
        <svg viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/></svg>
      </div>
      <h1>Garage Scholars</h1>
    </div>
    <div class="step" id="stepIndicator">Video Screen</div>
  </div>
  <div class="progress-bar">
    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
  </div>

  <div class="main">
    <!-- Screen: Loading (shown during verification) -->
    <div class="screen active" id="screenLoading">
      <div class="card welcome-card">
        <div style="margin-bottom:16px;">
          <div style="width:40px;height:40px;border:3px solid var(--border-default);border-top-color:var(--brand-teal);border-radius:50%;animation:spin 0.8s linear infinite;margin:0 auto;"></div>
        </div>
        <h2>Verifying your link...</h2>
        <p class="subtitle">One moment while we confirm your access.</p>
      </div>
    </div>

    <!-- Screen: Welcome -->
    <div class="screen" id="screenWelcome">
      <div class="card welcome-card">
        <div style="margin-bottom:16px;">
          <span class="badge badge-teal"><span class="badge-dot"></span>5 Questions</span>
        </div>
        <h2>Video Screen</h2>
        <p class="subtitle">Answer 5 quick questions on camera. Each recording is 60-90 seconds. The whole thing takes about 5 minutes.</p>
        <ul class="tips-list">
          <li>Find a quiet, well-lit spot</li>
          <li>Use your front-facing camera</li>
          <li>Speak naturally — no prep needed</li>
          <li>You'll see each question before recording starts</li>
          <li>One take per question — just be yourself</li>
        </ul>
        <p class="tips-note">Your camera and microphone will be requested on the next step.</p>
        <button class="btn btn-primary" id="btnStart">Start Video Screen</button>
      </div>
    </div>

    <!-- Screen: Recording -->
    <div class="screen" id="screenRecord">
      <div class="card prompt-card">
        <div class="prompt-label">Question <span id="promptNum">1</span> of 5</div>
        <div class="prompt-text" id="promptText"></div>
      </div>
      <div class="video-container">
        <video id="videoPreview" autoplay muted playsinline></video>
        <div class="timer-overlay prep" id="timerOverlay">Get ready...</div>
      </div>
      <button class="btn btn-primary" id="btnRecord" disabled>Recording starts automatically</button>
      <div class="status-msg" id="statusMsg"></div>
    </div>

    <!-- Screen: Uploading -->
    <div class="screen" id="screenUpload">
      <div class="card welcome-card">
        <h2>Uploading your videos...</h2>
        <p class="subtitle">Please don't close this page.</p>
        <div class="upload-track">
          <div class="upload-fill" id="uploadFill" style="width: 0%"></div>
        </div>
        <p class="status-msg" id="uploadStatus" style="margin-top:16px;">Uploading video 1 of 5...</p>
      </div>
    </div>

    <!-- Screen: Done -->
    <div class="screen" id="screenDone">
      <div class="card done-card">
        <div class="done-icon">
          <svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg>
        </div>
        <h2>You're all set!</h2>
        <p>Your video screen has been submitted. We'll review it and get back to you soon.</p>
        <p style="margin-top:16px;font-size:12px;color:var(--text-muted);font-weight:600;letter-spacing:0.5px;text-transform:uppercase;">You can close this page now</p>
      </div>
    </div>

    <!-- Screen: Error -->
    <div class="screen" id="screenError">
      <div class="card error-card">
        <div class="error-icon">
          <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>
        </div>
        <h2>Something went wrong</h2>
        <p id="errorMsg">We couldn't access your camera. Please make sure you've granted camera and microphone permissions, then try again.</p>
        <button class="btn btn-secondary" onclick="location.reload()" style="margin-top:20px;">Try Again</button>
      </div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-storage-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

  <script>
    // ── Firebase Config ──
    const firebaseConfig = {
      apiKey: "AIzaSyBPOosKjdOrj1dMLmgs1bH2Z9FoqqrZQI8",
      authDomain: "garage-scholars-v2.firebaseapp.com",
      projectId: "garage-scholars-v2",
      storageBucket: "garage-scholars-v2.firebasestorage.app",
      messagingSenderId: "583159785746",
      appId: "1:583159785746:web:87d8ed8f5634ea79c26bcb"
    };

    firebase.initializeApp(firebaseConfig);
    const storageRef = firebase.storage();
    const db = firebase.firestore();

    // ── Video Prompts (from Spec Step 6.3) ──
    const PROMPTS = [
      "Tell us about yourself. What do you do with your time, and what kind of work have you done?",
      "Describe something you built, fixed, or organized with your hands. Walk us through step by step.",
      "You're working solo at a customer's house and something goes wrong — maybe you crack a shelf or can't find a stud. What do you do?",
      "What does 'showing up' mean to you? If a friend described you as someone who always shows up, what would they mean?",
      "Why Garage Scholars? We're a startup — things move fast and roles shift. What about that sounds good or bad to you?"
    ];

    const PREP_SECONDS = 10;
    const RECORD_SECONDS = 90;

    // ── State ──
    let applicantId = null;
    let currentPrompt = 0;
    let mediaStream = null;
    let mediaRecorder = null;
    let recordedChunks = [];
    let recordedBlobs = [];
    let timerInterval = null;

    // ── DOM refs ──
    const $ = (id) => document.getElementById(id);

    // ── Get applicant ID from URL ──
    function getApplicantId() {
      const params = new URLSearchParams(window.location.search);
      return params.get('id');
    }

    // ── Screen navigation ──
    function showScreen(screenId) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      $(screenId).classList.add('active');
    }

    function updateProgress() {
      const pct = (currentPrompt / PROMPTS.length) * 100;
      $('progressFill').style.width = pct + '%';
      $('stepIndicator').textContent = `Question ${currentPrompt + 1} of ${PROMPTS.length}`;
    }

    // ── Camera setup ──
    async function setupCamera() {
      try {
        mediaStream = await navigator.mediaDevices.getUserMedia({
          video: { facingMode: 'user', width: { ideal: 1280 }, height: { ideal: 720 } },
          audio: true
        });
        $('videoPreview').srcObject = mediaStream;
        return true;
      } catch (err) {
        console.error('Camera access failed:', err);
        $('errorMsg').textContent = 'We couldn\'t access your camera. Please grant camera and microphone permissions in your browser settings, then reload this page.';
        showScreen('screenError');
        return false;
      }
    }

    // ── Recording logic ──
    function startRecording() {
      recordedChunks = [];

      const mimeTypes = ['video/webm;codecs=vp9,opus', 'video/webm;codecs=vp8,opus', 'video/webm', 'video/mp4'];
      let mimeType = '';
      for (const mt of mimeTypes) {
        if (MediaRecorder.isTypeSupported(mt)) { mimeType = mt; break; }
      }

      mediaRecorder = new MediaRecorder(mediaStream, mimeType ? { mimeType } : {});
      mediaRecorder.ondataavailable = (e) => {
        if (e.data.size > 0) recordedChunks.push(e.data);
      };
      mediaRecorder.onstop = () => {
        const blob = new Blob(recordedChunks, { type: mimeType || 'video/webm' });
        recordedBlobs.push(blob);
        onRecordingComplete();
      };
      mediaRecorder.start(1000);
    }

    function stopRecording() {
      if (mediaRecorder && mediaRecorder.state === 'recording') {
        mediaRecorder.stop();
      }
    }

    // ── Timer ──
    function startTimer(seconds, onTick, onDone) {
      let remaining = seconds;
      onTick(remaining);
      timerInterval = setInterval(() => {
        remaining--;
        onTick(remaining);
        if (remaining <= 0) {
          clearInterval(timerInterval);
          onDone();
        }
      }, 1000);
    }

    function formatTime(sec) {
      const m = Math.floor(sec / 60);
      const s = sec % 60;
      return `${m}:${s.toString().padStart(2, '0')}`;
    }

    // ── Prompt flow ──
    function showPrompt() {
      updateProgress();
      $('promptNum').textContent = currentPrompt + 1;
      $('promptText').textContent = PROMPTS[currentPrompt];
      $('btnRecord').disabled = true;
      $('btnRecord').textContent = 'Recording starts automatically';
      $('btnRecord').className = 'btn btn-primary';
      $('statusMsg').textContent = '';

      const overlay = $('timerOverlay');
      overlay.className = 'timer-overlay prep';

      startTimer(PREP_SECONDS,
        (rem) => { overlay.textContent = `Get ready... ${rem}s`; },
        () => {
          overlay.className = 'timer-overlay recording';
          overlay.innerHTML = '<span class="rec-dot"></span> REC';
          $('btnRecord').disabled = false;
          $('btnRecord').textContent = 'Stop Early';
          $('btnRecord').className = 'btn btn-danger';
          $('statusMsg').textContent = 'Speak naturally. Recording auto-stops at 90 seconds.';
          startRecording();

          startTimer(RECORD_SECONDS,
            (rem) => { overlay.innerHTML = `<span class="rec-dot"></span> ${formatTime(rem)}`; },
            () => { stopRecording(); }
          );
        }
      );
    }

    function onRecordingComplete() {
      clearInterval(timerInterval);
      currentPrompt++;

      if (currentPrompt < PROMPTS.length) {
        $('timerOverlay').className = 'timer-overlay prep';
        $('timerOverlay').textContent = 'Next question...';
        $('btnRecord').disabled = true;
        $('btnRecord').textContent = 'Next question loading...';
        $('btnRecord').className = 'btn btn-primary';
        setTimeout(() => showPrompt(), 1500);
      } else {
        uploadAll();
      }
    }

    // ── Upload all videos to Firebase Storage ──
    async function uploadAll() {
      showScreen('screenUpload');
      $('progressFill').style.width = '100%';

      const storagePaths = [];

      try {
        for (let i = 0; i < recordedBlobs.length; i++) {
          $('uploadStatus').textContent = `Uploading video ${i + 1} of ${recordedBlobs.length}...`;
          $('uploadFill').style.width = `${((i) / recordedBlobs.length) * 100}%`;

          const path = `hiring-videos/${applicantId}/video_${i + 1}.webm`;
          const ref = storageRef.ref(path);
          await ref.put(recordedBlobs[i], { contentType: 'video/webm' });
          storagePaths.push(path);

          $('uploadFill').style.width = `${((i + 1) / recordedBlobs.length) * 100}%`;
        }

        $('uploadStatus').textContent = 'Finalizing...';
        await db.collection('gs_hiringVideoCompletions').add({
          applicantId: applicantId,
          storagePaths: storagePaths,
          completedAt: firebase.firestore.FieldValue.serverTimestamp()
        });

        if (mediaStream) {
          mediaStream.getTracks().forEach(t => t.stop());
        }

        showScreen('screenDone');
      } catch (err) {
        console.error('Upload failed:', err);
        $('errorMsg').textContent = 'Upload failed. Please check your connection and try again.';
        showScreen('screenError');
      }
    }

    // ── Early stop button ──
    $('btnRecord').addEventListener('click', () => {
      if (mediaRecorder && mediaRecorder.state === 'recording') {
        clearInterval(timerInterval);
        stopRecording();
      }
    });

    // ── Security: Page-load verification ──
    // Verifies applicant ID + secure token before showing any content.
    // Token is generated server-side (crypto.randomBytes) and sent only via email.
    (async function verifyAccess() {
      const params = new URLSearchParams(window.location.search);
      const id = params.get('id');
      const token = params.get('token');

      if (!id || !token) {
        $('errorMsg').textContent = 'Invalid link. Please use the link from your email to access this page.';
        showScreen('screenError');
        return;
      }

      try {
        const doc = await db.collection('gs_hiringApplicants').doc(id).get();

        if (!doc.exists) {
          $('errorMsg').textContent = 'We couldn\'t find your application. Please contact us if you think this is an error.';
          showScreen('screenError');
          return;
        }

        const data = doc.data();

        // Verify the secure token matches
        if (!data.videoToken || data.videoToken !== token) {
          $('errorMsg').textContent = 'This link is invalid or has expired. Please contact us if you need help.';
          showScreen('screenError');
          return;
        }

        // Verify status allows video recording
        if (data.status !== 'video_invited' && data.status !== 'pending_video') {
          if (data.videoCompletedAt || data.status === 'video_scoring' || data.status === 'zoom_invited' || data.status === 'zoom_scheduled' || data.status === 'hired') {
            $('errorMsg').textContent = 'You\'ve already completed your video screen. We\'ll be in touch soon!';
          } else if (data.status === 'rejected') {
            $('errorMsg').textContent = 'This link is no longer active. Please contact us if you need help.';
          } else {
            $('errorMsg').textContent = 'This link is no longer active. Please contact us if you need help.';
          }
          showScreen('screenError');
          return;
        }

        // All checks passed — save ID and show welcome screen
        applicantId = id;
        showScreen('screenWelcome');
      } catch (err) {
        console.error('Verification failed:', err);
        $('errorMsg').textContent = 'Unable to verify your link. Please check your connection and try again.';
        showScreen('screenError');
      }
    })();

    // ── Start button (only accessible after page-load verification passed) ──
    $('btnStart').addEventListener('click', async () => {
      if (!applicantId) return;

      try {
        await db.collection('gs_hiringApplicants').doc(applicantId).update({
          status: 'pending_video'
        });
      } catch (err) {
        console.error('Status update failed:', err);
      }

      const cameraOk = await setupCamera();
      if (cameraOk) {
        showScreen('screenRecord');
        showPrompt();
      }
    });
  </script>
</body>
</html>
